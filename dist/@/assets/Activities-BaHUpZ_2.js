import{j as e,i as r,r as n,S as H}from"./index-CjXOYCek.js";import{P as K}from"./PageTitle-DFA0mJ57.js";import{h as o}from"./moment-C5S46NFB.js";import{E as q}from"./EmployeeServices-gydm101I.js";import{t as g,T as U,N as G}from"./react-datepicker-D1yPfg7-.js";import{a7 as J,ac as Q,ad as V}from"./Layout-mxREdH8E.js";import{A as W}from"./AnimatedContent-D_hXsWJF.js";import{q as X,i as Z,j as _}from"./optionsData-BUE2wvyU.js";import{u as ee}from"./useFilter-bfxQMeop.js";import"./index-CmvILeK1.js";const te=({activities:i})=>{const w={"On Desk":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-400","Lunch Break":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-400","Team Meeting":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-400","Client Meeting":"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-400","Office Celebration":"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-400","Interview Session":"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-400"};return e.jsx(e.Fragment,{children:e.jsx(r.TableBody,{className:"dark:bg-gray-900",children:i==null?void 0:i.map((l,y)=>e.jsxs(r.TableRow,{className:"text-center",children:[e.jsx(r.TableCell,{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${w[l.type]}`,children:l.type})}),e.jsx(r.TableCell,{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"text-sm",children:o(l.startTime).format("MMM DD YYYY, h:mm A")})}),e.jsx(r.TableCell,{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"text-sm",children:l.endTime?o(l.endTime).format("MMM DD YYYY, h:mm A"):"-"})}),e.jsx(r.TableCell,{className:"px-4 py-3 text-sm",children:l.endTime?(()=>{const u=o.duration(o(l.endTime).diff(o(l.startTime))),h=Math.floor(u.asHours()),d=u.minutes();return`${h}h ${d}m`})():l.isActive?"Active":"-"}),e.jsx(r.TableCell,{className:"px-4 py-3 text-sm",children:e.jsxs("span",{className:`px-2 py-1 text-xs rounded-full ${l.isActive?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-400"}`,children:[" ",l.isActive?"Active":"Completed"]})})]},y))})})},ue=()=>{const[i,w]=n.useState([]),[l,y]=n.useState([]),[u,h]=n.useState(!0),[d,c]=n.useState(1),[v,S]=n.useState(),[k,N]=n.useState({status:""}),[p,M]=n.useState(10),{setIsUpdate:ae}=n.useContext(H),[A,F]=n.useState(0),{dateRange:a,handleDateRangeChange:x,dateRangeType:j,handleDateRangeTypeChange:D,setSortBy:P,setSortOrder:E,setDateRange:R}=ee(i),b=(t=>{const{status:s}=k;return s?t.filter(m=>m.type.replace(" ","").toLowerCase()===s.toLowerCase()):t})(l),f=Math.ceil(b.length/p),C=n.useCallback(async()=>{try{h(!0);const t=await q.getActivityHistory();t.success&&(w(t.activities),c(1))}catch(t){S(t),console.error("Error fetching activities:",t)}finally{h(!1)}},[]),Y=t=>{const{name:s,value:m}=t.target;N({...k,[s]:m}),c(1)},B=t=>{const s=parseInt(t.target.value);M(s),c(1)},T=()=>{N({status:""}),R({startDate:null,endDate:null}),D("day"),c(1),P(""),E("asc")},L=()=>{d<f&&c(d+1)},O=()=>{d>1&&c(d-1)};n.useEffect(()=>{C()},[C,A]),n.useEffect(()=>{(()=>{if(!a.startDate||!a.endDate){y(i);return}const s=o(a.startDate).startOf("day"),m=o(a.endDate).endOf("day"),I=i.filter($=>o($.startTime).isBetween(s,m,"day","[]"));y(I),c(1)})()},[i,a]),n.useEffect(()=>{const t=()=>{F(s=>s+1)};return window.addEventListener("refreshActivitiesTable",t),()=>{window.removeEventListener("refreshActivitiesTable",t)}},[]);const z=()=>{const t=(d-1)*p,s=t+p;return b.slice(t,s)};return e.jsxs(e.Fragment,{children:[e.jsx(K,{children:"Activity History"}),e.jsx("div",{className:"relative pb-4",children:e.jsx(W,{children:e.jsx("div",{className:"rounded-lg shadow-md bg-white dark:bg-gray-700 p-3 max-w-full mb-4",children:e.jsxs("div",{className:"flex flex-wrap items-end gap-3 pb-2",children:[e.jsx("div",{className:"flex-none",children:e.jsxs("button",{onClick:T,className:"px-3 py-1.5 rounded-md text-xs bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-300",children:[e.jsx(J,{className:"mr-1 inline"}),"Reset"]})}),e.jsx("div",{className:"w-full sm:w-auto sm:flex-none sm:min-w-[150px]",children:e.jsxs("select",{name:"status",value:k.status,onChange:t=>Y(t),className:"w-full px-2.5 py-1.5 text-xs rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-1",children:[e.jsx("option",{value:"",children:"Select Activity"}),X.filter(t=>t.value!=="").map((t,s)=>e.jsx("option",{value:t.value,children:t.label},s))]})}),e.jsx("div",{className:"w-full sm:w-auto sm:flex-none sm:min-w-[120px]",children:e.jsx("select",{value:j,onChange:t=>D(t.target.value),className:"w-full px-2.5 py-1.5 text-xs rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-1",children:Z.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})}),j==="year"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full sm:w-auto sm:flex-none sm:min-w-[120px]",children:e.jsx(g,{selected:a.startDate,onChange:t=>x(t,a.endDate),selectsStart:!0,startDate:a.startDate,endDate:a.endDate,dateFormat:"yyyy",showYearPicker:!0,className:"w-full px-2.5 py-1.5 text-xs rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-1",placeholderText:"Start Year",popperClassName:"z-50"})}),e.jsx("div",{className:"w-full sm:w-auto sm:flex-none sm:min-w-[120px]",children:e.jsx(g,{selected:a.endDate,onChange:t=>x(a.startDate,t),selectsEnd:!0,startDate:a.startDate,endDate:a.endDate,dateFormat:"yyyy",showYearPicker:!0,className:"w-full px-2.5 py-1.5 text-xs rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-1",placeholderText:"End Year",popperClassName:"z-50"})})]}):j==="month"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full sm:w-auto sm:flex-none sm:min-w-[130px]",children:e.jsx(g,{selected:a.startDate,onChange:t=>x(t,a.endDate),selectsStart:!0,startDate:a.startDate,endDate:a.endDate,dateFormat:"MMM-yyyy",showMonthYearPicker:!0,className:"w-full px-2.5 py-1.5 text-xs rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-1",placeholderText:"Start Month",popperClassName:"z-50"})}),e.jsx("div",{className:"w-full sm:w-auto sm:flex-none sm:min-w-[130px]",children:e.jsx(g,{selected:a.endDate,onChange:t=>x(a.startDate,t),selectsEnd:!0,startDate:a.startDate,endDate:a.endDate,dateFormat:"MMM-yyyy",showMonthYearPicker:!0,className:"w-full px-2.5 py-1.5 text-xs rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-1",placeholderText:"End Month",popperClassName:"z-50"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full sm:w-auto sm:flex-none sm:min-w-[130px]",children:e.jsx(g,{selected:a.startDate,onChange:t=>x(t,a.endDate),selectsStart:!0,startDate:a.startDate,endDate:a.endDate,dateFormat:"dd-MMM-yyyy",className:"w-full px-2.5 py-1.5 text-xs rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-1",placeholderText:"Start Date",popperClassName:"z-50"})}),e.jsx("div",{className:"w-full sm:w-auto sm:flex-none sm:min-w-[130px]",children:e.jsx(g,{selected:a.endDate,onChange:t=>x(a.startDate,t),selectsEnd:!0,startDate:a.startDate,endDate:a.endDate,dateFormat:"dd-MMM-yyyy",className:"w-full px-2.5 py-1.5 text-xs rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-1",placeholderText:"End Date",popperClassName:"z-50"})})]}),e.jsx("div",{className:"w-full sm:w-auto sm:flex-none sm:min-w-[100px]",children:e.jsx("select",{value:p,onChange:t=>{B(t)},className:"w-full px-2.5 py-1.5 text-xs rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-1",children:_.map(t=>e.jsxs("option",{value:t.value,children:[t.label," per page"]},t.value))})}),b.length>0&&e.jsx("div",{className:"w-full sm:w-auto sm:flex-none sm:ml-auto",children:e.jsxs("div",{className:"flex items-center justify-center sm:justify-end space-x-1",children:[e.jsx("button",{onClick:O,disabled:d===1,className:`flex items-center justify-center p-1.5 h-8 w-8 rounded-md ${d===1?"bg-gray-200 dark:bg-gray-600 text-gray-400 dark:text-gray-500 cursor-not-allowed":"bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200"}`,children:e.jsx(Q,{className:"h-3 w-3"})}),e.jsxs("span",{className:"text-xs text-gray-700 dark:text-gray-300",children:[d," / ",f||1]}),e.jsx("button",{onClick:L,disabled:d===f,className:`flex items-center justify-center p-1.5 h-8 w-8 rounded-md ${d===f?"bg-gray-200 dark:bg-gray-600 text-gray-400 dark:text-gray-500 cursor-not-allowed":"bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-200"}`,children:e.jsx(V,{className:"h-3 w-3"})})]})})]})})})}),u?e.jsx(U,{row:12,col:6,width:190,height:20}):v?e.jsx("span",{className:"text-center mx-auto text-red-500",children:v}):b.length>0?e.jsx(r.TableContainer,{className:"mb-8",children:e.jsxs(r.Table,{children:[e.jsx(r.TableHeader,{children:e.jsxs("tr",{className:"h-14 ml-2 text-xs font-semibold tracking-wide text-left bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:[e.jsx(r.TableCell,{className:"text-center",children:"Activity"}),e.jsx(r.TableCell,{className:"text-center",children:"Start Time"}),e.jsx(r.TableCell,{className:"text-center",children:"End Time"}),e.jsx(r.TableCell,{className:"text-center",children:"Duration"}),e.jsx(r.TableCell,{className:"text-center",children:"Status"})]})}),e.jsx(te,{activities:z()})]})}):i.length>0?e.jsxs("div",{className:"p-4 text-center text-gray-600 dark:text-gray-400",children:[e.jsx("p",{children:"No activities match your filter criteria."}),e.jsx("button",{onClick:T,className:"mt-2 px-3 py-1.5 rounded-md text-sm bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500 text-gray-700 dark:text-gray-300",children:"Reset Filters"})]}):e.jsx(G,{title:"Sorry, There are no activities available."})]})};export{ue as default};
